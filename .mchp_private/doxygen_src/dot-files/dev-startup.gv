digraph dev_startup
{ 
    // Name Label and Format
    compound=true;

    graph[fontname="Handlee, Consolas, 'Courier New', Courier, Sans-Serif", fontsize=12];
    node[fontname="Handlee, Consolas, 'Courier New', Courier, Sans-Serif", fontsize=11];
    edge[fontname="Handlee, Consolas, 'Courier New', Courier, Sans-Serif", fontsize=11];

    ranksep=0.3;
    nodesep=0.6;
    rankdir=TB;
    splines = ortho;

    {
        // Application Layer
        label="Essential Device Initialization"
        rank = same;
        
        node [
            shape=diamond, style=filled, fontcolor=black, fillcolor=darkseagreen1, 
            width = 2.2
        ];

        reset[label="Device Reset"];
    }

    {
        node [
            shape=box, style=filled, fontcolor=black, fillcolor=darkseagreen1, 
            width = 2.2
        ]; 
            
        sys_init[label="System\nInitialization", fillcolor=white, URL="SYSTEM_Initialize"];
        usrper_init[label="User Peripheral\nInitialization", fillcolor=white, URL="sysUserPeriperhals_Initialize"];
        usrtsk_init[label="User Task\nInitialization", fillcolor=white, URL="sysUserTasks_Initialize"];
        ostim_init[label="OS Timer\nInitialization", fillcolor=white, URL="sysOsTimer_Enable"];
        main_loop[label="Main Loop", fillcolor=grey, URL="main"];

    }

    {
        node [
            shape=record, style=filled, fontcolor=black, fillcolor=darkseagreen1, 
            width = 2.2
            rankdir=TB, 
        ]; 

        check0[label="<check>Success? | { <no>No | <yes>Yes }"];
    }

    // Network Graph
    reset -> sys_init -> usrper_init -> usrtsk_init -> ostim_init;
    ostim_init -> check0:check;
    check0:no -> reset;
    check0:yes -> main_loop;
    

}
